<!doctype html>
<html lang="vi">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Qu√°n X√¥i Ngon</title>
    <meta name="color-scheme" content="light dark" />
    <style>
      :root {
        --bg: #0b0c10;
        --fg: #e6e6e6;
        --card: color-mix(in oklab, var(--bg), #fff 6%);
        --border: color-mix(in oklab, var(--fg), var(--bg) 85%);
        --muted: #9aa0a6;
        --accent: #ef4444;
        --accent-2: #f59e0b;
        --ring: color-mix(in oklab, var(--accent), #fff 20%);
        --shadow: 0 10px 30px rgba(0,0,0,.25);
      }
      @media (prefers-color-scheme: light) {
        :root {
          --bg: #ffffff;
          --fg: #111827;
          --card: #ffffff;
          --border: #e5e7eb;
          --muted: #6b7280;
          --accent: #dc2626;
          --accent-2: #f59e0b;
          --ring: color-mix(in oklab, var(--accent), #fff 15%);
          --shadow: 0 10px 30px rgba(17,24,39,.08);
        }
      }
      html, body {
        margin: 0;
        height: 100%;
        background:
          radial-gradient(1200px 600px at 80% -20%, color-mix(in oklab, var(--accent), transparent 88%), transparent 70%),
          radial-gradient(900px 500px at -10% 20%, color-mix(in oklab, var(--accent-2), transparent 88%), transparent 70%),
          var(--bg);
        color: var(--fg);
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      }
      .container {
        max-width: 960px;
        margin: 0 auto;
        padding: 24px 16px 64px;
      }
      header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 16px;
        margin-bottom: 16px;
        position: sticky;
        top: 0;
        z-index: 20;
        backdrop-filter: saturate(140%) blur(6px);
        background: color-mix(in oklab, var(--bg), transparent 30%);
        border-bottom: 1px solid color-mix(in oklab, var(--border), transparent 65%);
        padding: 12px 8px;
        border-radius: 12px;
      }
      .logo {
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .logo img {
        height: 60px;
        width: auto;
      }
      .logo-text {
        display: flex;
        flex-direction: column;
        gap: 2px;
      }
      .logo-text strong {
        font-size: 20px;
        letter-spacing: 1px;
      }
      .logo-text span {
        font-size: 13px;
        color: var(--muted);
        letter-spacing: 2px;
        text-transform: uppercase;
      }
      .tag {
        background: color-mix(in oklab, var(--accent), var(--bg) 70%);
        color: white;
        padding: 6px 10px;
        border-radius: 999px;
        font-weight: 700;
      }
      .promo-banner {
        background: linear-gradient(135deg, #F5A524 0%, #C96A3C 100%);
        color: white;
        text-align: center;
        padding: 6px 12px;
        font-weight: 700;
        font-size: 12px;
        letter-spacing: 0.5px;
        border-radius: 6px;
        margin-top: 6px;
        display: inline-block;
        box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      }
      @media (max-width: 540px) {
        .promo-banner {
          font-size: 11px;
          padding: 5px 10px;
          margin-top: 4px;
        }
      }
      .hero {
        border: 1px solid var(--border);
        background: linear-gradient(180deg, color-mix(in oklab, var(--card), transparent 0%), color-mix(in oklab, var(--card), transparent 0%)) padding-box,
                    conic-gradient(from 130deg at 50% 0%, color-mix(in oklab, var(--accent), transparent 65%), transparent 35%) border-box;
        border-radius: 14px;
        padding: 20px;
        margin-bottom: 18px;
        display: grid;
        grid-template-columns: 1.2fr 1fr;
        gap: 16px;
        box-shadow: var(--shadow);
      }
      @media (max-width: 740px) {
        .hero { grid-template-columns: 1fr; }
      }
      @media (max-width: 540px) {
        header {
          flex-direction: column;
          align-items: stretch;
          gap: 10px;
        }
        header .inline-actions {
          width: 100%;
          flex-direction: column;
        }
        header .inline-actions .btn {
          width: 100%;
          justify-content: center;
        }
        .hero {
          padding: 16px;
          gap: 12px;
        }
        .hero h1 {
          font-size: 22px;
          line-height: 1.3;
        }
        .badges {
          flex-direction: column;
          align-items: flex-start;
        }
        .hero .inline-actions {
          flex-direction: column;
          align-items: stretch;
        }
        .hero .inline-actions .btn,
        .hero .inline-actions .btn-outline {
          width: 100%;
          justify-content: center;
        }
        .tag {
          width: 100%;
          text-align: center;
        }
      }
      .hero h1 {
        font-size: 28px;
        margin: 0 0 6px;
      }
      .badges {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
        margin: 8px 0 6px;
      }
      .pill {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        border: 1px solid color-mix(in oklab, var(--border), transparent 10%);
        background: color-mix(in oklab, var(--card), #000 0%);
        padding: 6px 10px;
        border-radius: 999px;
        font-weight: 600;
        font-size: 13px;
      }
      .muted { color: var(--muted); }
      .hero-gallery {
        position: relative;
        border-radius: 16px;
        border: 1px solid var(--border);
        overflow: hidden;
        min-height: 280px;
        background: color-mix(in oklab, var(--bg), #fff 8%);
      }
      .hero-gallery .gallery-track {
        display: flex;
        transition: transform .5s ease;
        height: 100%;
      }
      .hero-gallery img { width: 100%; object-fit: cover; aspect-ratio: 4 / 3; }
      .gallery-nav {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        width: 36px;
        height: 36px;
        border-radius: 50%;
        border: none;
        background: rgba(0,0,0,.4);
        color: #fff;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .gallery-nav.prev { left: 10px; }
      .gallery-nav.next { right: 10px; }
      .gallery-dots {
        position: absolute;
        bottom: 10px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 6px;
      }
      .gallery-dots button {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        border: none;
        background: rgba(255,255,255,.4);
        cursor: pointer;
      }
      .gallery-dots button.active {
        background: #fff;
      }
      .hidden { display: none !important; }
      .cart-grid {
        flex: 1;
        display: grid;
        grid-template-columns: minmax(260px, 1fr) minmax(260px, 1fr);
        gap: 14px;
        padding: 16px;
        overflow: hidden;
      }
      @media (max-width: 700px) {
        .cart-grid { grid-template-columns: 1fr; padding: 12px; }
      }
      .cart-summary,
      .cart-items {
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 14px;
        background: color-mix(in oklab, var(--card), #000 4%);
        display: flex;
        flex-direction: column;
        gap: 12px;
        min-height: 0;
      }
      .cart-items { background: color-mix(in oklab, var(--card), #000 2%); }
      .cart-summary { overflow: auto; }
      .cart-items { overflow: auto; }
      .cart-items::-webkit-scrollbar,
      .cart-summary::-webkit-scrollbar { width: 6px; }
      .cart-items::-webkit-scrollbar-thumb,
      .cart-summary::-webkit-scrollbar-thumb {
        background: var(--border);
        border-radius: 999px;
      }
      .shipping-options-row {
        display:flex;
        gap:10px;
        flex-wrap:wrap;
        align-items:center;
        justify-content:space-between;
      }
      .select-wrapper {
        display:flex;
        flex-direction:column;
        gap:6px;
        min-width: 180px;
      }
      .select-wrapper label {
        font-size: 13px;
        font-weight: 600;
        color: var(--muted);
      }
      .select-wrapper select {
        appearance: none;
        padding: 10px 14px;
        border-radius: 12px;
        border: 1px solid color-mix(in oklab, var(--border), transparent 0%);
        background: linear-gradient(135deg, color-mix(in oklab, var(--bg), #fff 6%), color-mix(in oklab, var(--bg), #fff 2%));
        color: var(--fg);
        font-weight: 600;
        min-width: 180px;
        position: relative;
      }
      .select-shell {
        position: relative;
        display: flex;
        align-items: center;
      }
      .select-shell select {
        width: 100%;
        padding-right: 36px;
      }
      .select-caret {
        position: absolute;
        right: 12px;
        pointer-events: none;
        font-size: 14px;
        color: var(--muted);
      }
      .preorder-group {
        border: 1px dashed var(--border);
        border-radius: 10px;
        padding: 10px;
        margin-top: 6px;
        background: color-mix(in oklab, var(--card), #fff 4%);
      }
      .preorder-fields {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 8px;
        margin-top: 8px;
      }
      .preorder-fields label {
        font-size: 13px;
        color: var(--muted);
        display: flex;
        flex-direction: column;
        gap: 4px;
      }
      .preorder-fields input {
        padding: 8px 10px;
        border-radius: 8px;
        border: 1px solid var(--border);
        background: var(--card);
        color: var(--fg);
      }
      .payment-options {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin-top: 8px;
     
      }
      .payment-options label {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        border: 1px solid var(--border);
        border-radius: 999px;
        padding: 6px 12px;
        cursor: pointer;
        background: color-mix(in oklab, var(--card), #fff 4%);
      }
      .payment-options input { accent-color: var(--accent); }
      .shipping-pill input {
        accent-color: var(--accent);
        margin-right: 6px;
      }
      .qr-section {
        margin-top: 8px;
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 10px;
        text-align: center;
        background: color-mix(in oklab, var(--card), #fff 6%);
      }
      .qr-section img {
        width: 160px;
        height: 160px;
        object-fit: contain;
      }
      .grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 14px;
      }
      @media (max-width: 900px) {
        .grid { grid-template-columns: repeat(2, 1fr); }
      }
      @media (max-width: 600px) {
        .grid { grid-template-columns: 1fr; }
      }
      .card {
        border: 1px solid var(--border);
        background: linear-gradient(180deg, color-mix(in oklab, var(--card), transparent 0%), color-mix(in oklab, var(--card), transparent 0%));
        border-radius: 12px;
        overflow: hidden;
        display: flex;
        flex-direction: column;
        transition: transform .2s ease, box-shadow .2s ease, border-color .2s ease;
        position: relative;
      }
      .card:hover {
        transform: translateY(-3px);
        box-shadow: var(--shadow);
        border-color: color-mix(in oklab, var(--accent), var(--border) 70%);
      }
      .card img {
        width: 100%;
        height: 160px;
        object-fit: cover;
        transition: transform .25s ease;
      }
      .card:hover img {
        transform: scale(1.03);
      }
      .card .content {
        padding: 12px;
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      .price-label {
        font-size: 13px;
        color: var(--muted);
        margin-bottom: 2px;
      }
      .price-options {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
      }
      .price-option {
        flex: 1;
        min-width: 68px;
        padding: 8px 10px;
        border-radius: 12px;
        border: 1px solid color-mix(in oklab, var(--fg), var(--bg) 75%);
        background: color-mix(in oklab, var(--bg), #fff 8%);
        color: var(--fg);
        font-weight: 700;
        cursor: pointer;
        transition: all .15s ease;
      }
      .price-option.active {
        background: var(--accent);
        border-color: var(--accent);
        color: white;
        box-shadow: 0 6px 14px color-mix(in oklab, var(--accent), transparent 75%);
      }
      .chip {
        position: absolute;
        top: 10px;
        left: 10px;
        padding: 6px 10px;
        border-radius: 999px;
        background: color-mix(in oklab, var(--accent), var(--bg) 70%);
        color: white;
        font-weight: 700;
        box-shadow: 0 6px 18px rgba(0,0,0,.15);
        border: 1px solid color-mix(in oklab, var(--accent), transparent 30%);
      }
      .price { font-weight: 800; font-size: 18px; }
      .btn {
        appearance: none;
        border: 1px solid var(--border);
        background: var(--accent);
        color: white;
        padding: 10px 14px;
        border-radius: 10px;
        cursor: pointer;
        font-weight: 700;
        text-align: center;
        text-decoration: none;
        transition: transform .15s ease, box-shadow .15s ease, background .15s ease, border-color .15s ease, color .15s ease;
        box-shadow: 0 6px 16px color-mix(in oklab, var(--accent), transparent 75%);
      }
      .btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 12px 26px color-mix(in oklab, var(--accent), transparent 70%);
      }
      .btn:active {
        transform: translateY(0);
        box-shadow: 0 3px 12px color-mix(in oklab, var(--accent), transparent 80%);
      }
      .btn-outline {
        background: transparent;
        color: var(--fg);
        border-color: color-mix(in oklab, var(--fg), var(--bg) 75%);
      }
      .btn-outline:hover {
        border-color: var(--ring);
        background: color-mix(in oklab, var(--card), transparent 0%);
      }
      .btn-ghost {
        background: transparent;
        color: var(--fg);
        border-color: transparent;
        box-shadow: none;
      }
      .btn-ghost:hover {
        background: color-mix(in oklab, var(--card), transparent 0%);
      }
      .inline-actions {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }
      .cart-toast {
        position: fixed;
        bottom: 20px;
        right: 20px;
        background: color-mix(in oklab, var(--accent), #000 10%);
        color: #fff;
        padding: 12px 16px;
        border-radius: 12px;
        box-shadow: 0 10px 30px rgba(0,0,0,.25);
        opacity: 0;
        transform: translateY(20px);
        transition: opacity .25s ease, transform .25s ease;
        pointer-events: none;
        z-index: 200;
        font-weight: 600;
      }
      .cart-toast.show {
        opacity: 1;
        transform: translateY(0);
      }
      .cart-count-flash {
        animation: cartPulse .8s ease;
        color: var(--accent);
        font-weight: 800;
      }
      .cart-button-flash {
        animation: cartButtonPop .8s ease;
      }
      @keyframes cartPulse {
        0% { transform: scale(1); }
        30% { transform: scale(1.5); color: #ff0000; }
        60% { transform: scale(1.2); color: var(--accent); }
        100% { transform: scale(1); }
      }
      @keyframes cartButtonPop {
        0% { 
          transform: scale(1);
          box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        30% { 
          transform: scale(1.15);
          box-shadow: 0 8px 24px color-mix(in oklab, var(--accent), transparent 40%);
        }
        60% { 
          transform: scale(1.05);
          box-shadow: 0 4px 16px color-mix(in oklab, var(--accent), transparent 30%);
        }
        100% { 
          transform: scale(1);
          box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
      }
      footer {
        margin-top: 22px;
        border-top: 1px dashed var(--border);
        padding-top: 14px;
        font-size: 14px;
        color: var(--muted);
        display: flex;
        justify-content: space-between;
        gap: 10px;
        flex-wrap: wrap;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <div class="logo">
          <img src="branding/xoi-ba-su-logo.svg" alt="X√¥i B√† Su logo" />
          <div class="logo-text">
            <strong>X√¥i B√† Su</strong>
            <span>B·∫øp x√¥i ngon l√†ng ngh·ªÅ Ph√∫ Th∆∞·ª£ng ‚Ä¢ ph·ª•c v·ª• m·ªói ng√†y</span>
            <div class="promo-banner">‚è∞ ƒê·∫∑t tr∆∞·ªõc m·ªói s√°ng giao ngay t·∫≠n Ph√≤ng</div>
          </div>
        </div>
        <div class="inline-actions">
          <button id="openCartBtn" class="btn btn-outline">üß∫ Gi·ªè h√†ng (<span id="cartCount">0</span>)</button>
          <a class="btn-ghost btn" href="tel:0902217269">üìû 0902 217 269</a>
        </div>
      </header>

      <section class="hero">
        <div>
          <div class="pill">üå§Ô∏è M·ªõi s√°ng nay ‚Ä¢ N·∫•u t∆∞∆°i t·ª´ng m·∫ª</div>
          <h1 style="letter-spacing:.2px;">X√¥i n√≥ng m·ªói s√°ng, giao nhanh trong 15'</h1>
          <p class="muted">Nguy√™n li·ªáu s·∫°ch, topping ƒëa d·∫°ng: g√† x√©, ch√† b√¥ng, pate, tr·ª©ng, l·∫°p x∆∞·ªüng‚Ä¶</p>
          <div class="badges">
            <span class="pill">‚ö° Giao nhanh 15'</span>
            <span class="pill">‚≠ê 4.9/5 (1.2k ƒë√°nh gi√°)</span>
          </div>
          <div class="inline-actions" style="margin-top: 10px;">
            <a class="btn" href="#menu">üçΩÔ∏è Xem menu</a>
            <a class="btn btn-outline" href="tel:0902217269">üìû G·ªçi ƒë·∫∑t ngay</a>
            <span class="tag">üéâ Gi·∫£m 20% ƒë∆°n ƒë·∫ßu</span>
          </div>
        </div>
        <div class="hero-gallery" data-gallery>
          <div class="gallery-track">
            <img src="server/image/x√¥i x√©o.jpg" alt="X√¥i x√©o" />
            <img src="server/image/x√¥i ng√¥.jpg" alt="X√¥i ng√¥" />
            <img src="server/image/x√¥i g·∫•c.JPG" alt="X√¥i g·∫•c" />
            <img src="server/image/x√¥i l·∫°c.jpg" alt="X√¥i l·∫°c" />
            <img src="server/image/x√¥i d·ª´a.jpg" alt="X√¥i d·ª´a" />
            <img src="server/image/x√¥i ƒë·ªó ƒëen.jpg" alt="X√¥i ƒë·ªó ƒëen" />
            <img src="server/image/x√¥i ƒë·ªó xanh.png" alt="X√¥i ƒë·ªó xanh" />
            <img src="server/image/x√¥i ng≈© s·∫Øc.webp" alt="X√¥i ng≈© s·∫Øc" />
            <img src="server/image/x√¥i th·ªãt kho tr·ª©ng.jpg" alt="X√¥i th·ªãt kho tr·ª©ng" />
          </div>
          <button class="gallery-nav prev" type="button">‚Äπ</button>
          <button class="gallery-nav next" type="button">‚Ä∫</button>
          <div class="gallery-dots"></div>
        </div>
      </section>

      <h2 id="menu" style="margin: 0 0 10px;">Menu h√¥m nay</h2>
      <div class="grid">
        <article class="card">
          <img src="server/image/x√¥i x√©o.jpg" alt="X√¥i x√©o" />
          <div class="content">
            <div style="display:flex; justify-content:space-between; align-items:center;">
              <strong>X√¥i x√©o</strong>
            </div>
            <p class="muted">ƒê·∫≠m ƒë√† ƒë·ªó xanh nghi·ªÅn, h√†nh phi gi√≤n v√† m·ª° g√† th∆°m.</p>
            <div class="price-label">Ch·ªçn ph·∫ßn</div>
            <div class="price-options">
              <button type="button" class="price-option active" data-group="xoi-xeo" data-price="10000" data-label="Nh·ªè">10k</button>
              <button type="button" class="price-option" data-group="xoi-xeo" data-price="15000" data-label="V·ª´a">15k</button>
              <button type="button" class="price-option" data-group="xoi-xeo" data-price="20000" data-label="ƒê·∫ßy ƒë·∫∑n">20k</button>
            </div>
            <button class="btn add-to-cart" data-id="xoi-xeo" data-group="xoi-xeo" data-name="X√¥i x√©o" data-img="server/image/x√¥i x√©o.jpg">‚ûï Th√™m v√†o gi·ªè</button>
          </div>
        </article>

        <article class="card">
          <img src="server/image/x√¥i ng√¥.jpg" alt="X√¥i ng√¥" />
          <div class="content">
            <div style="display:flex; justify-content:space-between; align-items:center;">
              <strong>X√¥i ng√¥</strong>
            </div>
            <p class="muted">Ng√¥ n·∫øp m·ªÅm d·∫ªo, r·∫Øc d·ª´a n·∫°o v√† ƒë·∫≠u ph·ªông rang.</p>
            <div class="price-label">Ch·ªçn ph·∫ßn</div>
            <div class="price-options">
              <button type="button" class="price-option active" data-group="xoi-ngo" data-price="10000" data-label="Nh·ªè">10k</button>
              <button type="button" class="price-option" data-group="xoi-ngo" data-price="15000" data-label="V·ª´a">15k</button>
              <button type="button" class="price-option" data-group="xoi-ngo" data-price="20000" data-label="ƒê·∫ßy ƒë·∫∑n">20k</button>
            </div>
            <button class="btn add-to-cart" data-id="xoi-ngo" data-group="xoi-ngo" data-name="X√¥i ng√¥" data-img="server/image/x√¥i ng√¥.jpg">‚ûï Th√™m v√†o gi·ªè</button>
          </div>
        </article>

        <article class="card">
          <img src="server/image/x√¥i g·∫•c.JPG" alt="X√¥i g·∫•c" />
          <div class="content">
            <div style="display:flex; justify-content:space-between; align-items:center;">
              <strong>X√¥i g·∫•c</strong>
            </div>
            <p class="muted">M√†u g·∫•c t∆∞∆°i r√≥i, th∆°m b√πi v√† r·∫Øc m√® tr·∫Øng.</p>
            <div class="price-label">Ch·ªçn ph·∫ßn</div>
            <div class="price-options">
              <button type="button" class="price-option active" data-group="xoi-gac" data-price="10000" data-label="Nh·ªè">10k</button>
              <button type="button" class="price-option" data-group="xoi-gac" data-price="15000" data-label="V·ª´a">15k</button>
              <button type="button" class="price-option" data-group="xoi-gac" data-price="20000" data-label="ƒê·∫ßy ƒë·∫∑n">20k</button>
            </div>
            <button class="btn add-to-cart" data-id="xoi-gac" data-group="xoi-gac" data-name="X√¥i g·∫•c" data-img="server/image/x√¥i g·∫•c.JPG">‚ûï Th√™m v√†o gi·ªè</button>
          </div>
        </article>

        <article class="card">
          <img src="server/image/x√¥i l·∫°c.jpg" alt="X√¥i l·∫°c" />
          <div class="content">
            <div style="display:flex; justify-content:space-between; align-items:center;">
              <strong>X√¥i l·∫°c</strong>
            </div>
            <p class="muted">ƒê·∫≠u ph·ªông rang v√†ng, m√® tr·∫Øng, mu·ªëi m√® ng·ªçt b√πi.</p>
            <div class="price-label">Ch·ªçn ph·∫ßn</div>
            <div class="price-options">
              <button type="button" class="price-option active" data-group="xoi-lac" data-price="10000" data-label="Nh·ªè">10k</button>
              <button type="button" class="price-option" data-group="xoi-lac" data-price="15000" data-label="V·ª´a">15k</button>
              <button type="button" class="price-option" data-group="xoi-lac" data-price="20000" data-label="ƒê·∫ßy ƒë·∫∑n">20k</button>
            </div>
            <button class="btn add-to-cart" data-id="xoi-lac" data-group="xoi-lac" data-name="X√¥i l·∫°c" data-img="server/image/x√¥i l·∫°c.jpg">‚ûï Th√™m v√†o gi·ªè</button>
          </div>
        </article>

        <article class="card">
          <img src="server/image/x√¥i d·ª´a.jpg" alt="X√¥i d·ª´a" />
          <div class="content">
            <div style="display:flex; justify-content:space-between; align-items:center;">
              <strong>X√¥i d·ª´a</strong>
            </div>
            <p class="muted">X√¥i tr·∫Øng d·∫ªo, d·ª´a n·∫°o v√† s·ªØa d·ª´a b√©o ng·∫≠y.</p>
            <div class="price-label">Ch·ªçn ph·∫ßn</div>
            <div class="price-options">
              <button type="button" class="price-option active" data-group="xoi-dua" data-price="10000" data-label="Nh·ªè">10k</button>
              <button type="button" class="price-option" data-group="xoi-dua" data-price="15000" data-label="V·ª´a">15k</button>
              <button type="button" class="price-option" data-group="xoi-dua" data-price="20000" data-label="ƒê·∫ßy ƒë·∫∑n">20k</button>
            </div>
            <button class="btn add-to-cart" data-id="xoi-dua" data-group="xoi-dua" data-name="X√¥i d·ª´a" data-img="server/image/x√¥i d·ª´a.jpg">‚ûï Th√™m v√†o gi·ªè</button>
          </div>
        </article>

        <article class="card">
          <img src="server/image/x√¥i ƒë·ªó ƒëen.jpg" alt="X√¥i ƒë·ªó ƒëen" />
          <div class="content">
            <div style="display:flex; justify-content:space-between; align-items:center;">
              <strong>X√¥i ƒë·ªó ƒëen</strong>
            </div>
            <p class="muted">ƒê·ªó ƒëen h·∫ßm m·ªÅm, r∆∞·ªõi s·ªØa d·ª´a v√† m√® rang.</p>
            <div class="price-label">Ch·ªçn ph·∫ßn</div>
            <div class="price-options">
              <button type="button" class="price-option active" data-group="xoi-do-den" data-price="10000" data-label="Nh·ªè">10k</button>
              <button type="button" class="price-option" data-group="xoi-do-den" data-price="15000" data-label="V·ª´a">15k</button>
              <button type="button" class="price-option" data-group="xoi-do-den" data-price="20000" data-label="ƒê·∫ßy ƒë·∫∑n">20k</button>
            </div>
            <button class="btn add-to-cart" data-id="xoi-do-den" data-group="xoi-do-den" data-name="X√¥i ƒë·ªó ƒëen" data-img="server/image/x√¥i ƒë·ªó ƒëen.jpg">‚ûï Th√™m v√†o gi·ªè</button>
          </div>
        </article>

        <article class="card">
          <img src="server/image/x√¥i ƒë·ªó xanh.png" alt="X√¥i ƒë·ªó xanh" />
          <div class="content">
            <div style="display:flex; justify-content:space-between; align-items:center;">
              <strong>X√¥i ƒë·ªó xanh</strong>
            </div>
            <p class="muted">ƒê·ªó xanh c√† m·ªãn, r∆∞·ªõi n∆∞·ªõc c·ªët d·ª´a nh·∫π ng·ªçt.</p>
            <div class="price-label">Ch·ªçn ph·∫ßn</div>
            <div class="price-options">
              <button type="button" class="price-option active" data-group="xoi-do-xanh" data-price="10000" data-label="Nh·ªè">10k</button>
              <button type="button" class="price-option" data-group="xoi-do-xanh" data-price="15000" data-label="V·ª´a">15k</button>
              <button type="button" class="price-option" data-group="xoi-do-xanh" data-price="20000" data-label="ƒê·∫ßy ƒë·∫∑n">20k</button>
            </div>
            <button class="btn add-to-cart" data-id="xoi-do-xanh" data-group="xoi-do-xanh" data-name="X√¥i ƒë·ªó xanh" data-img="server/image/x√¥i ƒë·ªó xanh.png">‚ûï Th√™m v√†o gi·ªè</button>
          </div>
        </article>

        <article class="card">
          <img src="server/image/x√¥i ng≈© s·∫Øc.webp" alt="X√¥i ng≈© s·∫Øc" />
          <div class="content">
            <div style="display:flex; justify-content:space-between; align-items:center;">
              <strong>X√¥i ng≈© s·∫Øc</strong>
            </div>
            <p class="muted">5 m√†u t·ª± nhi√™n t·ª´ l√° c·∫©m, ngh·ªá, l√° d·ª©a, g·∫•c.</p>
            <div class="price-label">Ch·ªçn ph·∫ßn</div>
            <div class="price-options">
              <button type="button" class="price-option active" data-group="xoi-ngu-sac" data-price="10000" data-label="Nh·ªè">10k</button>
              <button type="button" class="price-option" data-group="xoi-ngu-sac" data-price="15000" data-label="V·ª´a">15k</button>
              <button type="button" class="price-option" data-group="xoi-ngu-sac" data-price="20000" data-label="ƒê·∫ßy ƒë·∫∑n">20k</button>
            </div>
            <button class="btn add-to-cart" data-id="xoi-ngu-sac" data-group="xoi-ngu-sac" data-name="X√¥i ng≈© s·∫Øc" data-img="server/image/x√¥i ng≈© s·∫Øc.webp">‚ûï Th√™m v√†o gi·ªè</button>
          </div>
        </article>

        <article class="card">
          <img src="server/image/x√¥i th·ªãt kho tr·ª©ng.jpg" alt="X√¥i th·ªãt kho tr·ª©ng" />
          <div class="content">
            <div style="display:flex; justify-content:space-between; align-items:center;">
              <strong>X√¥i th·ªãt kho tr·ª©ng</strong>
            </div>
            <p class="muted">Ba r·ªçi kho, tr·ª©ng c√∫t rim, m·ª° h√†nh v√† ƒë·ªì chua.</p>
            <div class="price-label">Ch·ªçn ph·∫ßn</div>
            <div class="price-options">
              <button type="button" class="price-option active" data-group="xoi-thit" data-price="10000" data-label="Nh·ªè">10k</button>
              <button type="button" class="price-option" data-group="xoi-thit" data-price="15000" data-label="V·ª´a">15k</button>
              <button type="button" class="price-option" data-group="xoi-thit" data-price="20000" data-label="ƒê·∫ßy ƒë·∫∑n">20k</button>
            </div>
            <button class="btn add-to-cart" data-id="xoi-thit" data-group="xoi-thit" data-name="X√¥i th·ªãt kho tr·ª©ng" data-img="server/image/x√¥i th·ªãt kho tr·ª©ng.jpg">‚ûï Th√™m v√†o gi·ªè</button>
          </div>
        </article>
      </div>

      <div id="cartOverlay" style="position: fixed; inset: 0; background: rgba(0,0,0,.35); display: none; z-index: 40;"></div>
      <aside id="cartDrawer" style="position: fixed; right: 0; top: 0; height: 100%; width: clamp(360px, 55vw, 640px); max-width: 100%; background: var(--bg); border-left: 1px solid var(--border); box-shadow: var(--shadow); transform: translateX(100%); transition: transform .25s ease; z-index: 50; display: flex; flex-direction: column;">
        <div style="display:flex; align-items:center; justify-content: space-between; padding: 14px; border-bottom: 1px solid var(--border); background: color-mix(in oklab, var(--bg), transparent 30%); backdrop-filter: blur(6px);">
          <strong>üß∫ Gi·ªè h√†ng</strong>
          <button id="closeCartBtn" class="btn btn-outline">ƒê√≥ng</button>
        </div>
        <div class="cart-grid">
          <div class="cart-summary">
            <div style="display:flex; justify-content: space-between;">
              <span class="muted">T·∫°m t√≠nh</span>
              <strong id="subtotalText">0‚Ç´</strong>
            </div>
            <div class="shipping-options-row">
              <label class="pill shipping-pill" style="border-radius: 12px;">
                <input type="radio" name="shipping" value="pickup" checked id="shippingPickup" />
                <span>Nh·∫≠n t·∫°i qu√°n (0‚Ç´)</span>
              </label>
              <label class="pill shipping-pill" style="border-radius: 12px;">
                <input type="radio" name="shipping" value="delivery" id="shippingDelivery" />
                <span>Giao nhanh (+1.000‚Ç´)</span>
              </label>
              <div class="select-wrapper">
                <label for="districtSelect">T√≤a HH giao h√†ng</label>
                <div class="select-shell">
                  <select id="districtSelect">
                    <option value="hh1a">HH1A</option>
                    <option value="hh1b">HH1B</option>
                    <option value="hh1c">HH1C</option>
                    <option value="hh2a">HH2A</option>
                    <option value="hh2b">HH2B</option>
                    <option value="hh2c">HH2C</option>
                    <option value="hh3a">HH3A</option>
                    <option value="hh3b">HH3B</option>
                    <option value="hh3c">HH3C</option>
                    <option value="hh4a">HH4A</option>
                    <option value="hh4b">HH4B</option>
                    <option value="hh4c">HH4C</option>
                  </select>
                  <span class="select-caret">‚ñæ</span>
                </div>
              </div>
            </div>
            <div style="display:flex; justify-content: space-between;">
              <span class="muted">Ph√≠ giao</span>
              <strong id="shippingText">0‚Ç´</strong>
            </div>
            <div class="preorder-group">
              <label style="font-weight:600; display:flex; align-items:center; gap:6px;">
                <input type="checkbox" id="preorderToggle" /> ƒê·∫∑t tr∆∞·ªõc cho ng√†y kh√°c
              </label>
              <div id="preorderFields" class="preorder-fields hidden">
                <label>Ng√†y nh·∫≠n
                  <input type="date" id="preorderDate" />
                </label>
                <label>Gi·ªù nh·∫≠n
                  <input type="time" id="preorderTime" />
                </label>
                <small style="grid-column: 1 / -1; color: var(--muted);">Ch·ªâ nh·∫≠n ƒë∆°n ƒë·∫∑t tr∆∞·ªõc cho ng√†y mai tr·ªü ƒëi.</small>
              </div>
            </div>
            <div style="display:flex; justify-content: space-between;">
              <span class="muted">Gi·∫£m gi√°</span>
              <strong id="discountText">0‚Ç´</strong>
            </div>
          <div class="payment-options">
            <label><input type="radio" name="paymentMethod" value="cod" checked /> Thanh to√°n khi nh·∫≠n</label>
            <label><input type="radio" name="paymentMethod" value="qr" /> Chuy·ªÉn kho·∫£n QR (-10%)</label>
          </div>
          <div id="qrSection" class="qr-section hidden">
            <p style="margin:0;">Ch·ªçn ‚ÄúChuy·ªÉn kho·∫£n QR‚Äù ƒë·ªÉ ƒë∆∞·ª£c gi·∫£m 10%. Khi nh·∫•n ‚Äúƒê·∫∑t h√†ng‚Äù, h·ªá th·ªëng s·∫Ω m·ªü trang QR v·ªõi s·∫µn s·ªë ti·ªÅn v√† n·ªôi dung chuy·ªÉn kho·∫£n.</p>
            <small style="display:block; margin-top:6px; color: var(--muted);">QR hi·ªÉn th·ªã s·∫µn s·ªë ti·ªÅn + n·ªôi dung (XBS + SƒêT). C·∫≠p nh·∫≠t s·ªë t√†i kho·∫£n trong ph·∫ßn c·∫•u h√¨nh n·∫øu c·∫ßn.</small>
          </div>
            <div style="display:flex; justify-content: space-between; font-size: 18px;">
              <span>T·ªïng c·ªông</span>
              <strong id="totalText">0‚Ç´</strong>
            </div>
            <form id="checkoutForm" style="display: grid; gap: 8px; margin-top: 6px;">
              <input id="custName" required placeholder="H·ªç v√† t√™n" style="padding: 10px 12px; border-radius: 8px; border: 1px solid var(--border); background: var(--card); color: var(--fg);" />
              <input id="custPhone" required placeholder="S·ªë ƒëi·ªán tho·∫°i" style="padding: 10px 12px; border-radius: 8px; border: 1px solid var(--border); background: var(--card); color: var(--fg);" />
              <input id="custAddress" placeholder="ƒê·ªãa ch·ªâ (ƒë·ªÉ tr·ªëng n·∫øu nh·∫≠n t·∫°i qu√°n)" style="padding: 10px 12px; border-radius: 8px; border: 1px solid var(--border); background: var(--card); color: var(--fg);" />
              <button class="btn" type="submit">üßæ ƒê·∫∑t h√†ng</button>
            </form>
          </div>
          <div id="cartItems" class="cart-items"></div>
        </div>
      </aside>

      <footer>
        <div>Giao t·∫°i: HH1A-D, HH2A-D, HH3A-D, HH4A-C</div>
        <div>Hotline ƒë·∫∑t h√†ng: 0902 217 269</div>
      </footer>
    </div>
    <div id="cartToast" class="cart-toast">ƒê√£ th√™m v√†o gi·ªè</div>
    <script>
      const API_BASE_URL = 'https://xoibasu-1.onrender.com';
      const currency = new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' });
      function vnd(n) { return currency.format(n).replace(/\s?‚Ç´/, '‚Ç´'); }

      const CART_KEY = 'cart-xoi';
      const cartCountEl = document.getElementById('cartCount');
      const openCartBtn = document.getElementById('openCartBtn');
      const closeCartBtn = document.getElementById('closeCartBtn');
      const cartOverlay = document.getElementById('cartOverlay');
      const cartDrawer = document.getElementById('cartDrawer');
      const cartItemsEl = document.getElementById('cartItems');
      const subtotalText = document.getElementById('subtotalText');
      const shippingText = document.getElementById('shippingText');
      const discountText = document.getElementById('discountText');
      const totalText = document.getElementById('totalText');
      const checkoutForm = document.getElementById('checkoutForm');
      const custName = document.getElementById('custName');
      const custPhone = document.getElementById('custPhone');
      const custAddress = document.getElementById('custAddress');
      const districtSelect = document.getElementById('districtSelect');
      const preorderToggle = document.getElementById('preorderToggle');
      const preorderFields = document.getElementById('preorderFields');
      const preorderDate = document.getElementById('preorderDate');
      const preorderTime = document.getElementById('preorderTime');
      const paymentRadios = document.querySelectorAll('input[name="paymentMethod"]');
      const qrSection = document.getElementById('qrSection');
      const toastEl = document.getElementById('cartToast');
      const priceSelections = {};
      let appliedDiscount = 0;
      let paymentDiscountValue = 0;
      let paymentMethod = 'cod';
      let toastTimer = null;
      let lastTotals = { subtotal: 0, shipping: 0, total: 0 };
      const QR_PAYMENT = {
        bank: 'vietinbank',           // m√£ ng√¢n h√†ng theo VietQR (vietinbank, bidv, mbbank, vcb, ... )
        account: '0902217269',        // s·ªë t√†i kho·∫£n nh·∫≠n ti·ªÅn
        name: 'NUGYEN THI GAI'        // t√™n ch·ªß t√†i kho·∫£n (in hoa kh√¥ng d·∫•u)
      };

      function setActivePrice(group, buttonEl) {
        if (!group || !buttonEl) return;
        document.querySelectorAll(`.price-option[data-group="${group}"]`).forEach(el => {
          el.classList.toggle('active', el === buttonEl);
        });
        priceSelections[group] = {
          price: Number(buttonEl.dataset.price),
          label: buttonEl.dataset.label || ''
        };
      }

      function getActivePrice(group) {
        if (!group) return null;
        if (priceSelections[group]) return priceSelections[group];
        const active = document.querySelector(`.price-option[data-group="${group}"].active`);
        if (active) {
          return { price: Number(active.dataset.price), label: active.dataset.label || '' };
        }
        const first = document.querySelector(`.price-option[data-group="${group}"]`);
        return first ? { price: Number(first.dataset.price), label: first.dataset.label || '' } : null;
      }

      document.querySelectorAll('.price-option.active').forEach(btn => {
        priceSelections[btn.dataset.group] = {
          price: Number(btn.dataset.price),
          label: btn.dataset.label || ''
        };
      });

      function loadCart() {
        try { return JSON.parse(localStorage.getItem(CART_KEY) || '[]'); } catch { return []; }
      }
      function saveCart(items) {
        localStorage.setItem(CART_KEY, JSON.stringify(items));
      }
      function getShippingFee() {
        const value = (document.querySelector('input[name="shipping"]:checked') || {}).value || 'pickup';
        if (value !== 'delivery') return 0;
        return 1000;
      }
      function calcSubtotal(items) {
        return items.reduce((s, it) => s + it.price * it.qty, 0);
      }
      function calcPaymentDiscount(subtotal) {
        return paymentMethod === 'qr' ? Math.round(subtotal * 0.1) : 0;
      }
      function openCart() {
        cartOverlay.style.display = 'block';
        cartDrawer.style.transform = 'translateX(0)';
      }
      function closeCart() {
        cartOverlay.style.display = 'none';
        cartDrawer.style.transform = 'translateX(100%)';
      }
      function renderCart() {
        const items = loadCart();
        const subtotal = calcSubtotal(items);
        const shipping = getShippingFee();
        paymentDiscountValue = calcPaymentDiscount(subtotal);
        appliedDiscount = paymentDiscountValue;
        const total = Math.max(0, subtotal + shipping - appliedDiscount);

        cartCountEl.textContent = String(items.reduce((s, it) => s + it.qty, 0));
        subtotalText.textContent = vnd(subtotal);
        shippingText.textContent = vnd(shipping);
        discountText.textContent = vnd(appliedDiscount);
        totalText.textContent = vnd(total);
        lastTotals = { subtotal, shipping, total };

        if (!items.length) {
          cartItemsEl.innerHTML = '<div class="muted" style="text-align:center; padding: 20px;">Gi·ªè h√†ng tr·ªëng</div>';
          return;
        }
        cartItemsEl.innerHTML = items.map(it => `
          <div style="display:flex; gap: 10px; border: 1px solid var(--border); background: var(--card); border-radius: 10px; padding: 8px; margin-bottom: 10px;">
            <img src="${it.img}" alt="${it.name}" style="width:64px; height:64px; object-fit:cover; border-radius: 8px; border: 1px solid var(--border);" />
            <div style="flex:1; display:flex; flex-direction:column; gap:6px;">
              <div style="display:flex; justify-content: space-between; gap: 6px; align-items: center;">
                <strong>${it.name}</strong>
                <button data-action="remove" data-id="${it.id}" class="btn btn-outline" style="padding:6px 8px;">‚úï</button>
              </div>
              <div style="display:flex; justify-content: space-between; align-items:center;">
                <div class="muted">${vnd(it.price)}</div>
                <div style="display:flex; align-items:center; gap: 8px;">
                  <button data-action="decr" data-id="${it.id}" class="btn btn-outline" style="padding:6px 10px;">‚àí</button>
                  <strong>${it.qty}</strong>
                  <button data-action="incr" data-id="${it.id}" class="btn btn-outline" style="padding:6px 10px;">+</button>
                </div>
              </div>
            </div>
          </div>
        `).join('');
      }
      function addToCart(product) {
        const items = loadCart();
        const found = items.find(i => i.id === product.id);
        if (found) found.qty += 1;
        else items.push({ ...product, qty: 1 });
        saveCart(items);
        renderCart();
        flashCartCount();
        showToast(`ƒê√£ th√™m ${product.name}`);
      }
      function updateQty(id, delta) {
        const items = loadCart();
        const it = items.find(i => i.id === id);
        if (!it) return;
        it.qty += delta;
        if (it.qty <= 0) {
          const idx = items.findIndex(i => i.id === id);
          items.splice(idx, 1);
        }
        saveCart(items);
        renderCart();
      }
      function removeItem(id) {
        const items = loadCart().filter(i => i.id !== id);
        saveCart(items);
        renderCart();
      }

      document.addEventListener('click', (e) => {
        const priceBtn = e.target.closest('.price-option');
        if (priceBtn) {
          setActivePrice(priceBtn.dataset.group, priceBtn);
          return;
        }
        const addBtn = e.target.closest('.add-to-cart');
        if (addBtn) {
          const group = addBtn.dataset.group;
          const selection = group ? getActivePrice(group) : null;
          const price = selection?.price || Number(addBtn.dataset.price || 0) || 10000;
          const variantLabel = selection?.label || '';
          const variantId = group ? `${addBtn.dataset.id}-${price}` : addBtn.dataset.id;
          const product = {
            id: variantId,
            name: variantLabel ? `${addBtn.dataset.name} (${variantLabel})` : addBtn.dataset.name,
            price,
            img: addBtn.dataset.img || ''
          };
          addToCart(product);
          return;
        }
        if (e.target === cartOverlay) closeCart();
        const actionBtn = e.target.closest('button[data-action]');
        if (actionBtn) {
          const id = actionBtn.dataset.id;
          const action = actionBtn.dataset.action;
          if (action === 'incr') updateQty(id, +1);
          if (action === 'decr') updateQty(id, -1);
          if (action === 'remove') removeItem(id);
        }
      });
      openCartBtn.addEventListener('click', openCart);
      closeCartBtn.addEventListener('click', closeCart);
      document.querySelectorAll('input[name="shipping"]').forEach(r => {
        r.addEventListener('change', renderCart);
      });
      districtSelect.addEventListener('change', renderCart);
      paymentRadios.forEach(radio => {
        radio.addEventListener('change', () => {
          paymentMethod = radio.value;
          qrSection.classList.toggle('hidden', paymentMethod !== 'qr');
          renderCart();
        });
      });
      function openQrPaymentPage({ silent = false } = {}) {
        const items = loadCart();
        if (!items.length) {
          if (!silent) alert('Gi·ªè h√†ng tr·ªëng, th√™m m√≥n tr∆∞·ªõc khi m·ªü QR.');
          return false;
        }
        if (paymentMethod !== 'qr') {
          if (!silent) alert('Ch·ªçn h√¨nh th·ª©c "Chuy·ªÉn kho·∫£n QR (-10%)" tr∆∞·ªõc nh√©.');
          return false;
        }
        if (!QR_PAYMENT.account) {
          alert('Ch∆∞a c·∫•u h√¨nh s·ªë t√†i kho·∫£n nh·∫≠n ti·ªÅn. Li√™n h·ªá admin.');
          return false;
        }
        const amount = Math.max(0, Number(lastTotals.total || 0));
        if (!amount) {
          alert('Kh√¥ng t√¨m th·∫•y s·ªë ti·ªÅn c·∫ßn thanh to√°n.');
          return false;
        }
        const phoneNote = (custPhone.value || '').replace(/\D/g, '').slice(-6);
        const note = phoneNote ? `XBS-${phoneNote}` : `XBS-${Date.now().toString().slice(-5)}`;
        const params = new URLSearchParams({
          amount,
          note,
          bank: QR_PAYMENT.bank,
          account: QR_PAYMENT.account,
          name: QR_PAYMENT.name,
          customer: custName.value.trim(),
          phone: custPhone.value.trim()
        });
        window.open('qr.html?' + params.toString(), '_blank', 'noopener');
        return true;
      }
      function setPreorderMinDate() {
        if (!preorderDate) return;
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        const minDate = tomorrow.toISOString().slice(0,10);
        preorderDate.min = minDate;
      }
      setPreorderMinDate();
      preorderToggle.addEventListener('change', () => {
        if (preorderToggle.checked) {
          preorderFields.classList.remove('hidden');
          setPreorderMinDate();
        } else {
          preorderFields.classList.add('hidden');
          preorderDate.value = '';
          preorderTime.value = '';
        }
      });
      checkoutForm.addEventListener('submit', (e) => {
        e.preventDefault();
        (async () => {
          const items = loadCart();
          if (!items.length) {
            alert('Gi·ªè h√†ng tr·ªëng.');
            return;
          }
          const shipping = getShippingFee();
          const subtotal = calcSubtotal(items);
          const total = Math.max(0, subtotal + shipping - appliedDiscount);
          const isDelivery = shipping > 0;
          if (!custName.value.trim() || !custPhone.value.trim() || (isDelivery && !custAddress.value.trim())) {
            alert('Vui l√≤ng ƒëi·ªÅn ƒë·ªß th√¥ng tin.');
            return;
          }
          if (preorderToggle.checked) {
            if (!preorderDate.value) {
              alert('Ch·ªçn ng√†y nh·∫≠n cho ƒë∆°n ƒë·∫∑t tr∆∞·ªõc.');
              return;
            }
            const selected = new Date(preorderDate.value);
            const tomorrow = new Date();
            tomorrow.setHours(0,0,0,0);
            tomorrow.setDate(tomorrow.getDate() + 1);
            if (selected < tomorrow) {
              alert('Ng√†y nh·∫≠n ph·∫£i t·ª´ ng√†y mai tr·ªü ƒëi.');
              return;
            }
          }
          if (paymentMethod === 'qr') {
            const opened = openQrPaymentPage({ silent: true });
            if (!opened) return;
          }
          try {
            const res = await fetch(`${API_BASE_URL}/api/orders`, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                customer: { name: custName.value.trim(), phone: custPhone.value.trim(), address: custAddress.value.trim() },
                items,
                shipping: isDelivery ? 'delivery' : 'pickup',
                preorder: {
                  enabled: preorderToggle.checked,
                  date: preorderToggle.checked ? preorderDate.value : '',
                  time: preorderToggle.checked ? preorderTime.value : ''
                },
                payment: { method: paymentMethod },
                totals: {
                  subtotal,
                  shipping,
                  total,
                  discount: appliedDiscount,
                  paymentDiscount: paymentDiscountValue
                }
              })
            });
            if (!res.ok) throw new Error('ƒê·∫∑t h√†ng th·∫•t b·∫°i');
            const data = await res.json();
            alert(`ƒê·∫∑t h√†ng th√†nh c√¥ng! M√£ ƒë∆°n: #${data.id}\nCh√∫ng t√¥i s·∫Ω li√™n h·ªá x√°c nh·∫≠n s·ªõm.`);
            localStorage.removeItem(CART_KEY);
            renderCart();
            closeCart();
          } catch (err) {
            console.error(err);
            alert('C√≥ l·ªói khi g·ª≠i ƒë∆°n. Vui l√≤ng th·ª≠ l·∫°i sau.');
          }
        })();
      });

      const gallery = document.querySelector('[data-gallery]');
      if (gallery) {
        const track = gallery.querySelector('.gallery-track');
        const slides = Array.from(track.children);
        const prevBtn = gallery.querySelector('.gallery-nav.prev');
        const nextBtn = gallery.querySelector('.gallery-nav.next');
        const dotsContainer = gallery.querySelector('.gallery-dots');
        let currentIndex = 0;
        let autoTimer;

        function updateSlide(idx) {
          currentIndex = (idx + slides.length) % slides.length;
          track.style.transform = `translateX(-${currentIndex * 100}%)`;
          dotsContainer.querySelectorAll('button').forEach((dot, dotIdx) => {
            dot.classList.toggle('active', dotIdx === currentIndex);
          });
        }

        function startAutoSlide() {
          stopAutoSlide();
          autoTimer = setInterval(() => updateSlide(currentIndex + 1), 4000);
        }

        function stopAutoSlide() {
          if (autoTimer) clearInterval(autoTimer);
        }

        slides.forEach((_, idx) => {
          const dot = document.createElement('button');
          dot.type = 'button';
          dot.addEventListener('click', () => {
            updateSlide(idx);
            startAutoSlide();
          });
          if (idx === 0) dot.classList.add('active');
          dotsContainer.appendChild(dot);
        });

        prevBtn.addEventListener('click', () => {
          updateSlide(currentIndex - 1);
          startAutoSlide();
        });

        nextBtn.addEventListener('click', () => {
          updateSlide(currentIndex + 1);
          startAutoSlide();
        });

        gallery.addEventListener('mouseenter', stopAutoSlide);
        gallery.addEventListener('mouseleave', startAutoSlide);

        updateSlide(0);
        startAutoSlide();
      }

      function flashCartCount() {
        if (!cartCountEl) return;
        // Animate s·ªë l∆∞·ª£ng
        cartCountEl.classList.remove('cart-count-flash');
        void cartCountEl.offsetWidth;
        cartCountEl.classList.add('cart-count-flash');
        setTimeout(() => cartCountEl.classList.remove('cart-count-flash'), 800);
        
        // Animate c·∫£ n√∫t gi·ªè h√†ng
        if (openCartBtn) {
          openCartBtn.classList.remove('cart-button-flash');
          void openCartBtn.offsetWidth;
          openCartBtn.classList.add('cart-button-flash');
          setTimeout(() => openCartBtn.classList.remove('cart-button-flash'), 800);
        }
      }

      function showToast(message) {
        if (!toastEl) return;
        toastEl.textContent = message;
        toastEl.classList.add('show');
        clearTimeout(toastTimer);
        toastTimer = setTimeout(() => {
          toastEl.classList.remove('show');
        }, 1600);
      }

      renderCart();
    </script>
  </body>
</html>